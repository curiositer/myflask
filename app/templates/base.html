{% extends 'bootstrap/base.html' %}

{% block head %}
    {{ super() }}
    <link href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.0/css/bootstrap-datepicker.standalone.min.css" rel="stylesheet">
    {% for jsfile_name in script_list %}
       <script src="{{ host }}/{{ jsfile_name }}.js"></script>    {# 获得所有所需的js文件#}
    {% endfor %}
{#    <script src="static/js/echarts.js"></script>#}

    <!-- 引入 echarts.js -->

{% endblock %}

{% block styles %}
    {{super()}}
    <link rel="stylesheet" href="{{url_for('static', filename='css/css.css')}}">
{% endblock %}

{% block title %}
    {% if title %}
    {{ title }} - 竞赛管理系统
    {% else %}
    欢迎来到竞赛管理系统
    {% endif %}
{% endblock %}

{% block navbar %}
    <img style="position:relative;left:200px;" src="{{ url_for('static', filename='image/buu_logo2.png') }}" alt="logo">
    <nav class="navbar mynavbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="{{ url_for('index') }}">主页</a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav"> {#导航栏左侧显示#}
{#                    <li><a href="{{ url_for('index') }}"></a></li>#}
{#                    {% if not current_user.is_anonymous %}#}
{#                    <li><a href="{{ url_for('user', username=current_user.username) }}">个人信息</a></li>#}
{#                    {% endif %}#}

{#                    <li>左侧</li>#}
                </ul>
                <ul class="nav navbar-right navbar-nav">    {#导航栏右侧显示#}
                    {% if current_user.is_anonymous %}
                        <li class="login"><a href="{{ url_for('login') }}">登陆</a></li>
                    {% else %}
                        {% if current_user.type=='admin' %}   {#管理员功能#}
                            <li><a href="{{ url_for('add_user') }}">添加用户</a></li>
                            <li><a href="{{ url_for('add_contest') }}">添加竞赛</a></li>
                            <li><a href="{{ url_for('add_notice') }}">添加公告</a></li>
                    {% elif current_user.type=='student' %} {#学生功能#}
    {#                    <a href="{{ url_for('apply_contest') }}">申报竞赛</a>#}   {# 已添加到竞赛列表中 #}

                    {% elif current_user.type=='teacher' %} {#教师功能#}

                    {% endif %}

                        <li><a href="{{ url_for('echarts', chart_type='contest_bar') }}">统计图表</a></li>
                        <li><a href="{{ url_for('relate', type='contest') }}">相关性分析</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            列表
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="{{ url_for('request_list') }}">申请列表</a></li>
                            <li><a href="{{ url_for('contest_list') }}">竞赛列表及申请</a></li>
                            <li><a href="{{ url_for('award_list') }}">参赛/获奖列表</a></li>
                            <li><a href="{{ url_for('notice_list') }}">公告列表</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            修改信息
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="{{ url_for('edit_profile') }}">修改基本信息</a></li>
                            {% if current_user.type == 'student' %}
                            <li><a href="{{ url_for('edit_work') }}">修改就业信息</a></li>
                            {% endif %}
                            <li class="divider"></li>
                            <li><a href="{{ url_for('edit_password') }}">修改密码</a></li>
                        </ul>
                    </li>
                    <li><a href="{{ url_for('logout') }}">注销</a></li>

                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
{% endblock %}

{% block content %}
    <body background="{{ url_for('static', filename='image/log_background.jpg') }}">
    <div class="container main_container">
        {% with messages = get_flashed_messages() %}     {# 显示警示信息#}
        {% if messages %}
            {% for message in messages %}
{#                <div class="alert alert-error" role="alert">#}
                <div class="alert alert-error" role="alert">
                    {{ message }}<button type="button" class="close" data-dismiss="alert">&times;</button>
                </div>
            {% endfor %}
        {% endif %}
        {% endwith %}

        {# 其他的模板应该用block app_content来继承#}
        {% block app_content %}{% endblock %}
    </div>
    <body>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.0/js/bootstrap-datepicker.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.0/locales/bootstrap-datepicker.zh-CN.min.js"></script>
{#    ueditor依赖的头文件#}
{#    <script type="text/javascript" charset="utf-8" src="{{ url_for('static', filename='ueditor/ueditor.config.js') }}"></script>#}
{#    <script type="text/javascript" charset="utf-8" src="{{ url_for('static', filename='ueditor/ueditor.all.min.js') }}"> </script>#}
{#    <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->#}
{#    <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->#}
{#    <script type="text/javascript" charset="utf-8" src="{{ url_for('static', filename='ueditor/lang/zh-cn/zh-cn.js') }}"></script>#}
    <script>
        //完成日期选择
        $('#time').datepicker({
            weekStart: 1,
            autoclose: true,
            daysOfWeekHighlighted: "0,6",
            format: "yyyy-mm-dd",
            language: "zh-CN"
        });
        function request_agree(req_id){//同意申请
            if(confirm('确定审核通过吗？')){
                $.post('/contest/agree', {
                    req :req_id,
                }).done(function () {
                    alert("审核成功");
                }).fail(function() {
                    alert("修改出错");
                });
            }
            else {
                return false;
            }
        }
        function request_disagree(req_id){//拒绝申请
            if(confirm('确定拒绝申请吗？')){
                $.post('/contest/disagree', {
                    req :req_id,
                }).done(function () {
                    alert("审核成功");
                }).fail(function() {
                    alert("修改出错");
                });
            }
            else {
                return false;
            }
        }
        function if_agree(req_id){//审核申请
            var mymessage= confirm("同意申请吗？");
            var ch_req = '#'+req_id;    {#用来表示选择器#}
            $.post('/contest/if_agree', {
                req :req_id,
                agree_status : mymessage
            }).done(function () {
                {#alert(mymessage);#}
                if (mymessage==true){
                    $(ch_req).html("已通过").css("color","green");
                    alert("修改成功");
                } else {
                    $(ch_req).html("已拒绝").css("color","red");
                    alert("修改成功");
                }
            }).fail(function() {
                alert("修改出错");
            });
            }
        function confirmdelete(){//确认是否删除
             if (!confirm("确认要删除？")) {  window.event.returnValue = false;  }
            }
    </script>
{% endblock %}
